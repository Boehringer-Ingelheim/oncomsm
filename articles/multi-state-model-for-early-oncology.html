<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="oncomsm">
<title>Multi-State Models for Oncology • oncomsm</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multi-State Models for Oncology">
<meta property="og:description" content="oncomsm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">oncomsm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/application-to-probability-of-success.html">Application to Probability of Success Calculation</a>
    <a class="dropdown-item" href="../articles/multi-state-model-for-early-oncology.html">Multi-State Models for Oncology</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Boehringer-Ingelheim/oncomsm/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="multi-state-model-for-early-oncology_files/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="multi-state-model-for-early-oncology_files/d3-3.3.8/d3.min.js"></script><script src="multi-state-model-for-early-oncology_files/dagre-0.4.0/dagre-d3.min.js"></script><link href="multi-state-model-for-early-oncology_files/mermaid-0.3.0/dist/mermaid.css" rel="stylesheet">
<script src="multi-state-model-for-early-oncology_files/mermaid-0.3.0/dist/mermaid.slim.min.js"></script><link href="multi-state-model-for-early-oncology_files/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="multi-state-model-for-early-oncology_files/chromatography-0.1/chromatography.js"></script><script src="multi-state-model-for-early-oncology_files/DiagrammeR-binding-1.0.9/DiagrammeR.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Multi-State Models for Oncology</h1>
                        <h4 data-toc-skip class="author">Kevin Kunzmann</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Boehringer-Ingelheim/oncomsm/blob/HEAD/vignettes/multi-state-model-for-early-oncology.Rmd" class="external-link"><code>vignettes/multi-state-model-for-early-oncology.Rmd</code></a></small>
      <div class="d-none name"><code>multi-state-model-for-early-oncology.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://boehringer-ingelheim.github.io/oncomsm/">oncomsm</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p><strong>tl;dr:</strong> <em>Tumor response data is often treated as binary endpoint in early oncology trials (objective response or progression free survival at x months). This ignores the fact that these are time-to-event endpoints. Instead, the multi-state characteristics of the data can be exploited to reduce bias at interim analyses and drive event prediction for probability of success calculations.</em></p>
<p>In early oncology trials, (objective tumor) response based on the RECIST criteria is often used as primary endpoint to establish the activity of a treatment. Response is often treated as binary variable although it is a delayed event endpoint. At the final analysis, this simplification is of little concern since all individuals tend to be followed up long enough to justify the assumption that non-responders are unlikely to still become responders. This approach is often plausible since individuals with tumors not responding to treatment ultimately progress. However, when continuously monitoring such a trial, the assumption of sufficient follow-up is no longer fulfilled and a simple binary analysis may be biased.</p>
<p>In this vignette, the problem is addressed by extending the statistic binary response model to a three-state model for “stable”, “response”, and “progression or death”. The respective transition numbers are given in the graph below.</p>
<div id="htmlwidget-a3fe27299c4fa3d2b64b" style="width:672px;height:200px;" class="DiagrammeR html-widget"></div>
<script type="application/json" data-for="htmlwidget-a3fe27299c4fa3d2b64b">{"x":{"diagram":"\ngraph LR\n  stable -- 1 --> response\n  response -- 3 --> progression[progression or death]\n  stable -- 2 --> progression[progression or death]\n"},"evals":[],"jsHooks":[]}</script><p>Once someone becomes a responder, this model only allows a transition to the combined progression or death state. This means that progression and death are not modeled as competing events and simplifies analysis greatly over a model like the one below:</p>
<div id="htmlwidget-281989253711558ea1ae" style="width:672px;height:200px;" class="DiagrammeR html-widget"></div>
<script type="application/json" data-for="htmlwidget-281989253711558ea1ae">{"x":{"diagram":"\ngraph LR\n  stable -- 1 --> response\n  response -- 3a --> progression\n  response -- 3b --> death\n  progression -- 4 --> death\n  stable -- 2a --> progression\n  stable -- 2b --> death\n"},"evals":[],"jsHooks":[]}</script><p>Coming back to the simpler model, there is still a competing event issue when starting from ‘stable’. Often, the convenient hazard-based approach is used to model multi-state situations like this. The hazard-based approach is intuitive, especially when considering non-parametric estimation, and co variate inclusion is well-understood. However, a hazard-based approach has several disadvantages:</p>
<ol style="list-style-type: decimal">
<li><p>The hazard scale is difficult to interpret since it is a momentary risk, not a probability. This leads to problems with prior specification in a Bayesian setting. The Bayesian approach is, however, particularly useful in the early development process since it allows to augment data with prior opinion or evidence and thus improve accuracy.</p></li>
<li><p>A hazard based, non-Markov multi-state model leads to intractable expressions for the implicitly given transition probabilities. Hence they need to be calculated by simulation which makes the model less convenient to work with if transition probabilities a or of primary interest. Since the (objective) response rate often plays an important role in the analysis of early oncology trials, this is a disadvantage.</p></li>
</ol>
<p>An alternative framework to model multi-state data are mixture models. For details, see <span class="citation">Jackson et al. (2022)</span> and <span class="citation">Jackson (2022)</span>. Here, we describe the concrete application to he simplified “stable”, “response”, “progression” model. The approach is similar to <span class="citation">Aubel et al. (2021)</span>.</p>
<p>Assuming that the transition process can be described as a semi-Markov process is one way of rendering modeling tractable. This means that the time to the next transition only depends on the time already spent in a state, not on prior jumps. Additionally, it is assumed that the transition times between states conditional on both originating and target state can be described by Weibull distributions. This parametric family encompasses the exponential distribution with constant transition rates as special cases but also allows increasing or decreasing hazards over time.</p>
<p>Let <span class="math inline">\(\tau_{S}\)</span> be the transition time from the “stable” state and <span class="math inline">\(\tau_{R}\)</span> the transition tome from the “response” state (also “sojourn” times). Let further <span class="math inline">\(R\)</span> be a binary random variable with <span class="math inline">\(R=1\)</span> if a response occurs, then the model can be specified as:</p>
<p><span class="math display">\[
\begin{align}
R &amp;\sim \operatorname{Bernoulli}(p) \\
\tau_{S} \,|\, R = 1 &amp;\sim \operatorname{Weibull}(k[1], \lambda[1]) \\
\tau_{S} \,|\, R = 0 &amp;\sim \operatorname{Weibull}(k[2], \lambda[2]) \\
\tau_{R}             &amp;\sim \operatorname{Weibull}(k[3], \lambda[3])
\end{align}
\]</span> where <span class="math inline">\(k\)</span> is the vector of shape- and <span class="math inline">\(\lambda\)</span> the vector of scale parameters. Let further <span class="math inline">\(f_i(t)\)</span> be the PDF of the Weibull distribution of transition <span class="math inline">\(i\in\{1,2,3\}\)</span> as indicated in the above figure and let <span class="math inline">\(F_i(t)\)</span> the corresponding CDF. This model implies that <span class="math display">\[
\operatorname{Pr}\big[\,\tau_{S} &gt; t \,\big]  = p\cdot(1 - F_1(t))  + (1 - p)\cdot(1 - F_2(t))\\
\]</span> hence, it can be seen as a mixture model.</p>
<p>The median of a Weibull-distributed random variable is directly related to shape and scale parameters. Since the former is more convenient to interpret, the Weibull distributions are parameterized directly via their shape and median. The scale parameter can then be recovered via the relationship</p>
<p><span class="math display">\[
\operatorname{scale} = \frac{\operatorname{median}}{\log(2)^{1/\operatorname{shape}}} . 
\]</span></p>
<p>The following priors are used:</p>
<ol style="list-style-type: decimal">
<li>a normal prior for the log-odds of response <span class="math inline">\(\operatorname{logit}(p) \sim \mathcal{N}(\mu_p,\sigma_p^2)\)</span>
</li>
<li>a truncated normal prior for the median of each transition <span class="math inline">\(\operatorname{median}_{\,i} \sim \mathcal{N}(\mu_i,\sigma_i^2)[\,0,\infty)\)</span>
</li>
<li>a flat prior on the shape of each transition <span class="math inline">\(\operatorname{shape}_{\,i} \sim \operatorname{Uniform}(a_i, b_i)\)</span>
</li>
<li>it is assumed that the observation process (visit spacing) is fixed, e.g. every 6 weeks. This is irrelevant for inference, but important for sampling forward from the model since it cannot be assumed that transition times are observed exactly but only at the regular visits.</li>
</ol>
<p>We treat recruitment times as independent of outcome. They can be modeled separately if required.</p>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<div class="section level3">
<h3 id="specifying-the-model">Specifying the model<a class="anchor" aria-label="anchor" href="#specifying-the-model"></a>
</h3>
<p>We assume a time-scale of months.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mdl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/srp_model.html">create_srp_model</a></span><span class="op">(</span></span>
<span>    <span class="co"># names of the arms/groups</span></span>
<span>    group_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"intervention"</span><span class="op">)</span>,</span>
<span>    <span class="co"># per-group logodds of response|stable</span></span>
<span>    logodds_mean <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/logodds.html">logodds</a></span><span class="op">(</span><span class="fl">.25</span><span class="op">)</span>, <span class="fu"><a href="../reference/logodds.html">logodds</a></span><span class="op">(</span><span class="fl">.5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    logodds_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.75</span>, <span class="fl">.75</span><span class="op">)</span>,</span>
<span>    <span class="co"># m[i,j] is the median time to next event for group i and transition j</span></span>
<span>    median_time_to_next_event <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">6</span>,</span>
<span>      <span class="fl">2</span>, <span class="fl">8</span>, <span class="fl">12</span></span>
<span>    <span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>,  nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="co"># fixed standard deviation of the prior for all median times</span></span>
<span>    median_time_to_next_event_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> </span>
<span>      <span class="fl">1</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>,  nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">3</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="co"># uniform prior over the shape parameter, difficult to identify, </span></span>
<span>    <span class="co"># better keep it tight to avoid issues with the sampler</span></span>
<span>    shape_min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> </span>
<span>      <span class="fl">.75</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>,  nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">3</span></span>
<span>    <span class="op">)</span>,</span>
<span>    shape_max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> </span>
<span>      <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>,  nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">3</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="co"># the visit interval</span></span>
<span>    visit_spacing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">1.2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co"># TODO: implement a nice summary / print function here</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="prior-checks">Prior checks<a class="anchor" aria-label="anchor" href="#prior-checks"></a>
</h3>
<p>First, we plot the cumulative distribution functions (CDF) of the time-to-next-event over the first 36 (months) and the CDF of the response probabilities per group. These are based on a sample drawn from the prior distribution of the model. We can re-use the same parameter sample for sampling from the prior-predictive distribution by separating the sampling from the plotting steps. If no parameter sample is provided to the plotting function it samples automatically.</p>
<p>Often, the rate of progression free survival (PFS) at a particular time point is of interest. This quantity is a direct function of the model parameters. Since the simplified model does not distinguish between progression or death, we denote the combined endpoint as “progression”. <span class="math display">\[
\begin{align}
\operatorname{PFS}(t) :&amp;= \operatorname{Pr}\big[\,\text{no progression before } t\,\big] \\
  &amp;= 1 - \operatorname{Pr}\big[\,\text{progression before } t\,] \\
  &amp;= 1 - \operatorname{Pr}\big[\,\text{progression before } t\,|\, \text{response}\,]\cdot\operatorname{Pr}\big[\,\text{response}\,] \\
  &amp;\qquad- \operatorname{Pr}\big[\,\text{progression before } t\,|\, \text{no response}\,]\cdot\operatorname{Pr}\big[\,\text{no response}\,] \\
  &amp;= 1 - p\cdot\int_0^t f_1(u) \cdot F_2(t - u) \operatorname{d}u - (1 - p)\cdot F_3(t) \ .
\end{align}
\]</span> The integral arises from the need to reflect the uncertainty over the state change from “stable” to “response” on the way to “progression”. Any parameter sample thus also induces a sample of the PFS rate at any given time point and the curve of PFS rate over time corresponds to the survival function of the “progression or death” event.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">smpl_prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_prior.html">sample_prior</a></span><span class="op">(</span><span class="va">mdl</span>, warmup <span class="op">=</span> <span class="fl">500</span>, nsim <span class="op">=</span> <span class="fl">2000</span>, seed <span class="op">=</span> <span class="fl">36L</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mdl</span>, dt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">36</span><span class="op">)</span>, sample <span class="op">=</span> <span class="va">smpl_prior</span><span class="op">)</span></span></code></pre></div>
<p><img src="multi-state-model-for-early-oncology_files/figure-html/plotting-the-prior-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="section level4">
<h4 id="sampling-from-the-prior-predictive-distribution">Sampling from the prior-predictive distribution<a class="anchor" aria-label="anchor" href="#sampling-from-the-prior-predictive-distribution"></a>
</h4>
<p>Next, we draw samples from the prior-predictive distribution of the model. We sample 100 trials with 30 individuals per arm. Here, we can re-use the sample prior sample already used for plotting.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl_prior_predictive</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_predictive.html">sample_predictive</a></span><span class="op">(</span></span>
<span>  <span class="va">mdl</span>, </span>
<span>  sample <span class="op">=</span> <span class="va">smpl_prior</span>,</span>
<span>  n_per_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30L</span>, <span class="fl">30L</span><span class="op">)</span>, </span>
<span>  nsim <span class="op">=</span> <span class="fl">100</span>, </span>
<span>  seed <span class="op">=</span> <span class="fl">3423423</span></span>
<span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># estimate of the response rates</span></span>
<span><span class="va">tbl_prior_predictive</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">from</span> <span class="op">==</span> <span class="st">"stable"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">group_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>p_response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">to</span> <span class="op">==</span> <span class="st">"response"</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">#&gt;   group_id     p_response</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> control           0.258</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> intervention      0.498</span></span>
<span></span>
<span><span class="co"># crude approximation of the median jump times from "stable"</span></span>
<span><span class="va">tbl_prior_predictive</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>  </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">from</span> <span class="op">==</span> <span class="st">"stable"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">group_id</span>, <span class="va">from</span>, <span class="va">to</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>t_jump_approx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">t_min</span> <span class="op">+</span> <span class="va">t_max</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> </span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 4</span></span></span>
<span><span class="co">#&gt;   group_id     from   to          t_jump_approx</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> control      stable progression           1.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> control      stable response              3  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> intervention stable progression           7.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> intervention stable response              1.8</span></span></code></pre></div>
<p>The generated data can also be visualized in swimmer plots</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># TODO: improve sorting</span></span>
<span><span class="fu"><a href="../reference/plot_mstate.html">plot_mstate</a></span><span class="op">(</span><span class="va">mdl</span>, <span class="va">tbl_prior_predictive</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">iter</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="multi-state-model-for-early-oncology_files/figure-html/plot-preior-predictive-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="inference">Inference<a class="anchor" aria-label="anchor" href="#inference"></a>
</h2>
<div class="section level3">
<h3 id="building-a-visit-data-set">Building a visit data set<a class="anchor" aria-label="anchor" href="#building-a-visit-data-set"></a>
</h3>
<p>Usually, data will come in the form of individual visits, not yet in the form of interval censored transitions. We can mimic this for the sake of example by converting one of our prior predictive samples to visit data. Note that the conversion is not exact since the mstate format does not contain information about potential visits between the interval boundaries.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl_visits</span> <span class="op">&lt;-</span> <span class="va">tbl_prior_predictive</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">iter</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/mstate_to_visits.html">mstate_to_visits</a></span><span class="op">(</span><span class="va">mdl</span>, <span class="va">.</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'mstate_to_visits.srp_model' is experimental</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">tbl_visits</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 505 × 4</span></span></span>
<span><span class="co">#&gt;    subject_id group_id     t state      </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1          control    0   stable     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1          control    1.2 stable     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1          control    2.4 progression</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 10         control    0   stable     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 10         control    1.2 stable     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 10         control    2.4 stable     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 10         control    3.6 stable     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 10         control    4.8 stable     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 10         control    6   stable     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 10         control    7.2 stable     </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 495 more rows</span></span></span></code></pre></div>
<p>Next, we add recruitment times.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">recruitment_rate_overall</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="co"># sample from poisson process</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">31532</span><span class="op">)</span></span>
<span><span class="va">tbl_sot</span> <span class="op">&lt;-</span> <span class="va">tbl_visits</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>    <span class="va">subject_id</span>, </span>
<span>    <span class="va">group_id</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># permute groups</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    t_sot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>, rate <span class="op">=</span> <span class="va">recruitment_rate_overall</span><span class="op">)</span><span class="op">)</span> <span class="co"># poisson recruitment process</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># add to visit times</span></span>
<span><span class="va">tbl_visits</span> <span class="op">&lt;-</span> <span class="va">tbl_visits</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">tbl_sot</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"subject_id"</span>, <span class="st">"group_id"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>t <span class="op">=</span> <span class="va">t</span> <span class="op">+</span> <span class="va">t_sot</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">t_sot</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># convert back to mstate format and plot</span></span>
<span><span class="va">tbl_visits</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/visits_to_mstate.html">visits_to_mstate</a></span><span class="op">(</span>start_state <span class="op">=</span> <span class="st">"stable"</span>, absorbing_states <span class="op">=</span> <span class="st">"progression"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/plot_mstate.html">plot_mstate</a></span><span class="op">(</span><span class="va">mdl</span>, <span class="va">.</span>, relative_to_sot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="multi-state-model-for-early-oncology_files/figure-html/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="a-hypothetical-interim-analysis">A hypothetical interim analysis<a class="anchor" aria-label="anchor" href="#a-hypothetical-interim-analysis"></a>
</h3>
<p>If we now cut the data at 15 months after the first SoT, we can imitate a hypothetical interim analysis.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl_visits_interim</span> <span class="op">&lt;-</span> <span class="va">tbl_visits</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">t</span> <span class="op">&lt;=</span> <span class="fl">15</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># convert to mstate plot</span></span>
<span><span class="va">tbl_mstate_interim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/visits_to_mstate.html">visits_to_mstate</a></span><span class="op">(</span></span>
<span>  <span class="va">tbl_visits_interim</span>, </span>
<span>  start_state <span class="op">=</span> <span class="st">"stable"</span>, </span>
<span>  absorbing_states <span class="op">=</span> <span class="st">"progression"</span>, </span>
<span>  now <span class="op">=</span> <span class="fl">15</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_mstate.html">plot_mstate</a></span><span class="op">(</span><span class="va">mdl</span>, <span class="va">tbl_mstate_interim</span>, relative_to_sot <span class="op">=</span> <span class="cn">FALSE</span>, now <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<p><img src="multi-state-model-for-early-oncology_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;"></p>
<p>We can check the observed response rates. Careful, due to the different time-to-event these will be biased.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># estimate of the response rates (biased due to missing!)</span></span>
<span><span class="va">tbl_mstate_interim</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">from</span> <span class="op">==</span> <span class="st">"stable"</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">to</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">group_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>p_response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">to</span> <span class="op">==</span> <span class="st">"response"</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">#&gt;   group_id     p_response</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> control           0.214</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> intervention      0.545</span></span></code></pre></div>
<p>We can now do inference by drawing sample from the posterior distribution. Clearly, this is a very extreme sample from the prior and a shift of the posterior as compared to the prior is to be expected.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">smpl_posterior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_posterior.html">sample_posterior</a></span><span class="op">(</span></span>
<span>  <span class="va">mdl</span>, </span>
<span>  <span class="va">tbl_mstate_interim</span>, </span>
<span>  refresh <span class="op">=</span> <span class="fl">500</span>, nsim <span class="op">=</span> <span class="fl">5000</span>, warmup <span class="op">=</span> <span class="fl">250</span>, seed <span class="op">=</span> <span class="fl">76947</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; SAMPLING FOR MODEL 'srp_model' NOW (CHAIN 1).</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Gradient evaluation took 9.6e-05 seconds</span></span>
<span><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.96 seconds.</span></span>
<span><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Iteration:    1 / 5250 [  0%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  251 / 5250 [  4%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  750 / 5250 [ 14%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 1250 / 5250 [ 23%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 1750 / 5250 [ 33%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 2250 / 5250 [ 42%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 2750 / 5250 [ 52%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 3250 / 5250 [ 61%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 3750 / 5250 [ 71%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 4250 / 5250 [ 80%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 4750 / 5250 [ 90%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 5250 / 5250 [100%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1:  Elapsed Time: 0.94149 seconds (Warm-up)</span></span>
<span><span class="co">#&gt; Chain 1:                10.3547 seconds (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1:                11.2962 seconds (Total)</span></span>
<span><span class="co">#&gt; Chain 1:</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mdl</span>, dt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">36</span><span class="op">)</span>, sample <span class="op">=</span> <span class="va">smpl_posterior</span><span class="op">)</span></span></code></pre></div>
<p><img src="multi-state-model-for-early-oncology_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">smpl_posterior</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/parameter_sample_to_tibble.html">parameter_sample_to_tibble</a></span><span class="op">(</span><span class="va">mdl</span>, <span class="va">.</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">parameter</span> <span class="op">==</span> <span class="st">"p"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">group_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>    p_posterior_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>, </span>
<span>    q25 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">value</span>, probs <span class="op">=</span> <span class="fl">.25</span><span class="op">)</span>, </span>
<span>    q75 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">value</span>, probs <span class="op">=</span> <span class="fl">.75</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 4</span></span></span>
<span><span class="co">#&gt;   group_id     p_posterior_mean   q25   q75</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> control                 0.227 0.176 0.285</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> intervention            0.529 0.451 0.606</span></span></code></pre></div>
<p>The Bayesian approach specifies a full generative model. This can be used to draw samples from the posterior predictive distribution for the individuals still at risk and the ones not yet recruited. The process is the same as for sampling from the prior predictive - just with replacing the prior distribution with the posterior distribution obtained from conditioning on any available data.</p>
<p>At 15 months into the trial, there are still individuals who have not been recruited (the final sample size was set to 30 per group).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl_interim_sample_sizes</span> <span class="op">&lt;-</span> <span class="va">tbl_mstate_interim</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">group_id</span>, <span class="va">subject_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">group_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">tbl_interim_sample_sizes</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">#&gt;   group_id         n</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> control         20</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> intervention    20</span></span></code></pre></div>
<p>We now sample recruitment dates and randomization probabilities for the still-to-be-recruited individuals.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl_to_be_recruited</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>    group_id <span class="op">=</span> <span class="va">tbl_interim_sample_sizes</span><span class="op">$</span><span class="va">group_id</span>,</span>
<span>    n_to_be_recruited <span class="op">=</span> <span class="fl">30</span> <span class="op">-</span> <span class="va">tbl_interim_sample_sizes</span><span class="op">$</span><span class="va">n</span>  </span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    tmp <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>      <span class="va">n_to_be_recruited</span>, </span>
<span>      <span class="op">~</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>        <span class="co"># use unique identifiers to avoid clashing between groups</span></span>
<span>        subject_id <span class="op">=</span> <span class="fu">uuid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/uuid/man/UUIDgenerate.html" class="external-link">UUIDgenerate</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">.</span><span class="op">)</span>,</span>
<span>        <span class="co"># sample recruitment times per group using half the overall </span></span>
<span>        <span class="co"># recruitment rate</span></span>
<span>        t_sot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">.</span>, rate <span class="op">=</span> <span class="va">recruitment_rate_overall</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">n_to_be_recruited</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="co"># add information on starting state etc to expand to full mstate table</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    from <span class="op">=</span> <span class="st">"stable"</span>,</span>
<span>    to <span class="op">=</span> <span class="cn">NA_character_</span>,</span>
<span>    t_min <span class="op">=</span> <span class="va">t_sot</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="fl">30</span>, <span class="co"># preclude events on the day of recruitment</span></span>
<span>    t_max <span class="op">=</span> <span class="cn">Inf</span> <span class="co"># right censored</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">tbl_to_be_recruited</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 20 × 7</span></span></span>
<span><span class="co">#&gt;    group_id     subject_id                        t_sot from  to     t_min t_max</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> control      6747644f-a8a2-4776-99b1-eca0248…  0.151 stab… <span style="color: #BB0000;">NA</span>     0.184   <span style="color: #BB0000;">Inf</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> control      c2075efd-069e-42c2-a4c9-a115c3a…  1.33  stab… <span style="color: #BB0000;">NA</span>     1.36    <span style="color: #BB0000;">Inf</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> control      5de1600e-37e5-49d3-bfc2-e969c27…  2.76  stab… <span style="color: #BB0000;">NA</span>     2.79    <span style="color: #BB0000;">Inf</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> control      440b5a36-ce87-403d-abc5-efc1d6f…  3.88  stab… <span style="color: #BB0000;">NA</span>     3.91    <span style="color: #BB0000;">Inf</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> control      13f0d337-5972-4a34-83a1-910c1b7…  4.79  stab… <span style="color: #BB0000;">NA</span>     4.82    <span style="color: #BB0000;">Inf</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> control      3440be8a-30e6-42e2-abeb-96823d8…  6.10  stab… <span style="color: #BB0000;">NA</span>     6.13    <span style="color: #BB0000;">Inf</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> control      071fa3f9-e479-4cbc-be62-7dc8c52…  7.78  stab… <span style="color: #BB0000;">NA</span>     7.82    <span style="color: #BB0000;">Inf</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> control      ee8dd348-9af4-448d-89fe-d292b89…  8.16  stab… <span style="color: #BB0000;">NA</span>     8.20    <span style="color: #BB0000;">Inf</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> control      15143d79-56e2-4a3c-aae9-78c6d16… 10.0   stab… <span style="color: #BB0000;">NA</span>    10.1     <span style="color: #BB0000;">Inf</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> control      5dfd6104-b0bf-4666-b96c-b00d402… 13.9   stab… <span style="color: #BB0000;">NA</span>    13.9     <span style="color: #BB0000;">Inf</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> intervention 34dbfcfb-7e58-498f-aeb4-34d8a07…  0.554 stab… <span style="color: #BB0000;">NA</span>     0.587   <span style="color: #BB0000;">Inf</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> intervention 7341d91e-e912-4e3b-8431-3c5d471…  0.724 stab… <span style="color: #BB0000;">NA</span>     0.758   <span style="color: #BB0000;">Inf</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> intervention 026bcb8a-f169-4295-b7b6-90de574…  2.31  stab… <span style="color: #BB0000;">NA</span>     2.34    <span style="color: #BB0000;">Inf</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> intervention 70af71b4-8693-4eb4-b291-3e3010b…  2.35  stab… <span style="color: #BB0000;">NA</span>     2.38    <span style="color: #BB0000;">Inf</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> intervention 93473574-1076-4fbb-b87d-1532e16…  2.88  stab… <span style="color: #BB0000;">NA</span>     2.92    <span style="color: #BB0000;">Inf</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> intervention fbab29e3-bb28-4e34-8879-cd144d7…  3.04  stab… <span style="color: #BB0000;">NA</span>     3.07    <span style="color: #BB0000;">Inf</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> intervention 478a8ff9-7730-43a8-9461-951487b…  4.32  stab… <span style="color: #BB0000;">NA</span>     4.35    <span style="color: #BB0000;">Inf</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> intervention 15614f6d-7ea5-4032-ab73-1bd098e…  5.15  stab… <span style="color: #BB0000;">NA</span>     5.18    <span style="color: #BB0000;">Inf</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> intervention ebb7cd45-d639-4231-87cb-f6ee712…  6.29  stab… <span style="color: #BB0000;">NA</span>     6.33    <span style="color: #BB0000;">Inf</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> intervention 438e3975-e416-4da7-845c-8c0db7f…  6.52  stab… <span style="color: #BB0000;">NA</span>     6.55    <span style="color: #BB0000;">Inf</span></span></span></code></pre></div>
<p>The hypothetical future first-visits can now be combined with the interim data and the trajectories can be sampled forward using the already fitted posterior distribution.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl_mstate_interim_forward</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">tbl_mstate_interim</span>, <span class="va">tbl_to_be_recruited</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tbl_posterior_predictive</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/impute_predictive.html">impute_predictive</a></span><span class="op">(</span></span>
<span>    <span class="va">mdl</span>,</span>
<span>    data <span class="op">=</span> <span class="va">tbl_mstate_interim_forward</span>, </span>
<span>    sample <span class="op">=</span> <span class="va">smpl_posterior</span>,</span>
<span>    nsim <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_mstate.html">plot_mstate</a></span><span class="op">(</span><span class="va">mdl</span>, <span class="va">tbl_posterior_predictive</span>, relative_to_sot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="multi-state-model-for-early-oncology_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Repeatedly sampling from the posterior-predictive distribution allows to evaluate any decision criterion as if the full trial were completed since the individual-level data is practically imputed using the posterior predictive distribution. This allows to compute the Probability of Success, see [???].</p>
</div>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.2.1 (2022-06-23)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 20.04.5 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0</span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] ggplot2_3.3.6      dplyr_1.0.10       oncomsm_0.1.0.9000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] Rcpp_1.0.9           tidyr_1.2.1          visNetwork_2.1.0    </span></span>
<span><span class="co">#&gt;  [4] prettyunits_1.1.1    ps_1.7.1             rprojroot_2.0.3     </span></span>
<span><span class="co">#&gt;  [7] digest_0.6.29        utf8_1.2.2           R6_2.5.1            </span></span>
<span><span class="co">#&gt; [10] backports_1.4.1      stats4_4.2.1         evaluate_0.16       </span></span>
<span><span class="co">#&gt; [13] highr_0.9            pillar_1.8.1         rlang_1.0.6         </span></span>
<span><span class="co">#&gt; [16] uuid_1.1-0           callr_3.7.2          jquerylib_0.1.4     </span></span>
<span><span class="co">#&gt; [19] checkmate_2.1.0      rmarkdown_2.16       DiagrammeR_1.0.9    </span></span>
<span><span class="co">#&gt; [22] pkgdown_2.0.6        labeling_0.4.2       textshaping_0.3.6   </span></span>
<span><span class="co">#&gt; [25] desc_1.4.2           stringr_1.4.1        htmlwidgets_1.5.4   </span></span>
<span><span class="co">#&gt; [28] loo_2.5.1            munsell_0.5.0        compiler_4.2.1      </span></span>
<span><span class="co">#&gt; [31] xfun_0.33            rstan_2.21.7         pkgconfig_2.0.3     </span></span>
<span><span class="co">#&gt; [34] systemfonts_1.0.4    pkgbuild_1.3.1       htmltools_0.5.3     </span></span>
<span><span class="co">#&gt; [37] tidyselect_1.1.2     tibble_3.1.8         gridExtra_2.3       </span></span>
<span><span class="co">#&gt; [40] codetools_0.2-18     matrixStats_0.62.0   fansi_1.0.3         </span></span>
<span><span class="co">#&gt; [43] crayon_1.5.1         withr_2.5.0          grid_4.2.1          </span></span>
<span><span class="co">#&gt; [46] jsonlite_1.8.0       gtable_0.3.1         lifecycle_1.0.2     </span></span>
<span><span class="co">#&gt; [49] magrittr_2.0.3       StanHeaders_2.21.0-7 scales_1.2.1        </span></span>
<span><span class="co">#&gt; [52] RcppParallel_5.1.5   cli_3.4.1            stringi_1.7.8       </span></span>
<span><span class="co">#&gt; [55] cachem_1.0.6         farver_2.1.1         fs_1.5.2            </span></span>
<span><span class="co">#&gt; [58] bslib_0.4.0          ellipsis_0.3.2       ragg_1.2.2          </span></span>
<span><span class="co">#&gt; [61] generics_0.1.3       vctrs_0.4.1          RColorBrewer_1.1-3  </span></span>
<span><span class="co">#&gt; [64] tools_4.2.1          glue_1.6.2           purrr_0.3.4         </span></span>
<span><span class="co">#&gt; [67] processx_3.7.0       parallel_4.2.1       fastmap_1.1.0       </span></span>
<span><span class="co">#&gt; [70] yaml_2.3.5           inline_0.3.19        colorspace_2.0-3    </span></span>
<span><span class="co">#&gt; [73] memoise_2.0.1        knitr_1.40           patchwork_1.1.2     </span></span>
<span><span class="co">#&gt; [76] sass_0.4.2</span></span></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-aubel_bayesian_2021" class="csl-entry">
Aubel, Paul, Marine Antigny, Ronan Fougeray, Frédéric Dubois, and Gaëlle Saint‐Hilary. 2021. <span>“A Bayesian Approach for Event Predictions in Clinical Trials with Time‐to‐event Outcomes.”</span> <em>Statistics in Medicine</em> 40 (28): 6344–59. <a href="https://doi.org/10.1002/sim.9186" class="external-link">https://doi.org/10.1002/sim.9186</a>.
</div>
<div id="ref-jackson_flexible_2022" class="csl-entry">
Jackson, Christopher. 2022. <span>“Flexible Parametric Multi-State Modelling with Flexsurv.”</span> <a href="https://cran.r-project.org/web/packages/flexsurv/" class="external-link">https://cran.r-project.org/web/packages/flexsurv/</a>.
</div>
<div id="ref-jackson_comparison_2022" class="csl-entry">
Jackson, Christopher, Brian Tom, Peter Kirwan, Sema Mandal, Shaun R Seaman, Kevin Kunzmann, Anne Presanis, and Daniela De Angelis. 2022. <span>“A Comparison of Two Frameworks for Multi-State Modelling, Applied to Outcomes After Hospital Admissions with <span>COVID</span>-19.”</span> <em>Statistical Methods in Medical Research</em>, July, 09622802221106720. <a href="https://doi.org/10.1177/09622802221106720" class="external-link">https://doi.org/10.1177/09622802221106720</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Kevin Kunzmann.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
