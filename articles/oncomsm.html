<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="oncomsm">
<title>Multi-State Models for Oncology • oncomsm</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multi-State Models for Oncology">
<meta property="og:description" content="oncomsm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">oncomsm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/oncomsm.html">Get started</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/bhmbasket-integration.html">Integration with bhmbasket</a>
    <a class="dropdown-item" href="../articles/web_only/application-to-probability-of-success.html">Application to Probability of 'go'</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Boehringer-Ingelheim/oncomsm/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="oncomsm_files/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="oncomsm_files/d3-3.3.8/d3.min.js"></script><script src="oncomsm_files/dagre-0.4.0/dagre-d3.min.js"></script><link href="oncomsm_files/mermaid-0.3.0/dist/mermaid.css" rel="stylesheet">
<script src="oncomsm_files/mermaid-0.3.0/dist/mermaid.slim.min.js"></script><link href="oncomsm_files/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="oncomsm_files/chromatography-0.1/chromatography.js"></script><script src="oncomsm_files/DiagrammeR-binding-1.0.9/DiagrammeR.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Multi-State Models for Oncology</h1>
                        <h4 data-toc-skip class="author">Kevin
Kunzmann</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Boehringer-Ingelheim/oncomsm/blob/HEAD/vignettes/oncomsm.Rmd" class="external-link"><code>vignettes/oncomsm.Rmd</code></a></small>
      <div class="d-none name"><code>oncomsm.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://boehringer-ingelheim.github.io/oncomsm/">oncomsm</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<p><strong>tl;dr:</strong> <em>The multi-state characteristics of
RECIST-like visit data in oncology can be exploited to reduce bias at
interim analyses of objective response rate and drive event prediction
for probability of success calculations.</em></p>
<p>In early oncology trials, (objective tumor) response based on the
RECIST criteria is often used as primary endpoint to establish the
activity of a treatment. Often, response is treated as binary variable
although it is a delayed event endpoint. At the final analysis, this
simplification is of little concern since all individuals tend to be
followed up long enough to ignore the small amount of censoring.
However, when continuously monitoring such a trial, the assumption of
sufficient follow-up is no longer fulfilled at interim analyses and a
simple binary analysis is biased.</p>
<p>The problem can be addressed by extending the statistic binary
response model to a three-state model for “stable”, “response”, and
“progression or death”. The respective transition numbers are given in
the graph below.</p>
<div id="htmlwidget-d335622c135c5e8829a4" style="width:672px;height:200px;" class="DiagrammeR html-widget"></div>
<script type="application/json" data-for="htmlwidget-d335622c135c5e8829a4">{"x":{"diagram":"\ngraph LR\n  stable -- 1 --> response\n  response -- 3 --> progression[progression or death]\n  stable -- 2 --> progression[progression or death]\n"},"evals":[],"jsHooks":[]}</script><p>Often, a hazard-based approach is used to model multi-state data.
However, a hazard-based approach has several disadvantages:</p>
<ol style="list-style-type: decimal">
<li><p>The hazard scale is difficult to interpret since it is a
momentary risk, not a probability. This leads to problems with prior
specification in a Bayesian setting. The Bayesian approach is, however,
particularly useful in the early development process since it allows to
augment data with prior opinion or evidence and thus improve
accuracy.</p></li>
<li><p>A hazard based, non-Markov multi-state model leads to intractable
expressions for the implicitly given transition probabilities. Hence
they need to be calculated by simulation which makes the model less
convenient to work with if transition probabilities a or of primary
interest. Since the (objective) response rate often plays an important
role in the analysis of early oncology trials, this is a
disadvantage.</p></li>
</ol>
<p>An alternative framework to model multi-state data are mixture
models. For details, see <span class="citation">Jackson et al.
(2022)</span> and <span class="citation">Jackson (2022)</span>. Here, we
describe the concrete application to he simplified “stable”, “response”,
“progression” model. The approach is similar to <span class="citation">Aubel et al. (2021)</span> and <span class="citation">Beyer et al. (2020)</span>.</p>
<p>Here, a semi-Markov approach is used. This means that the time to the
next transition only depends on the time already spent in a state, not
on the full history of previous jumps. Additionally, it is assumed that
the transition times between states conditional on both originating and
target state can be described by Weibull distributions. This parametric
family encompasses the exponential distribution with constant transition
rates as special cases but also allows increasing or decreasing hazards
over time.</p>
<p>Let <span class="math inline">\(T_{S}\)</span> be the transition time
from the “stable” state and <span class="math inline">\(T_{R}\)</span>
the transition tome from the “response” state (also “sojourn” times).
Let further <span class="math inline">\(R\)</span> be a binary random
variable with <span class="math inline">\(R=1\)</span> if a response
occurs, then the model can be specified as:</p>
<p><span class="math display">\[
\begin{align}
R &amp;\sim \operatorname{Bernoulli}(p) \\
T_{S} \,|\, R = 1 &amp;\sim \operatorname{Weibull}(k_1, \lambda_1) \\
T_{S} \,|\, R = 0 &amp;\sim \operatorname{Weibull}(k_2, \lambda_2) \\
T_{R}             &amp;\sim \operatorname{Weibull}(k_3, \lambda_3)
\end{align}
\]</span> where <span class="math inline">\(k\)</span> is the vector of
shape- and <span class="math inline">\(\lambda\)</span> the vector of
scale parameters. Let further <span class="math inline">\(f_i(t)\)</span> be the PDF of the Weibull
distribution of transition <span class="math inline">\(i\in\{1,2,3\}\)</span> as indicated in the above
figure and let <span class="math inline">\(F_i(t)\)</span> the
corresponding CDF. This model implies that <span class="math display">\[
\operatorname{Pr}\big[\,T_{S} &gt; t \,\big]  = p\cdot(1 - F_1(t))  + (1
- p)\cdot(1 - F_2(t))\\
\]</span> hence, it can be seen as a mixture model.</p>
<p>The median of a Weibull-distributed random variable is directly
related to shape and scale parameters. Since the former is more
convenient to interpret, the Weibull distributions are parameterized
directly via their shape and median. The scale parameter can then be
recovered via the relationship</p>
<p><span class="math display">\[
\operatorname{scale} =
\frac{\operatorname{median}}{\log(2)^{1/\operatorname{shape}}} .
\]</span></p>
<p>The following priors are used:</p>
<ol style="list-style-type: decimal">
<li>a normal prior for the log-odds of response <span class="math inline">\(\operatorname{logit}(p) \sim
\mathcal{N}(\mu_p,\sigma_p^2)\)</span>
</li>
<li>a truncated normal prior for the median of each transition <span class="math inline">\(\operatorname{median}_{\,i} \sim
\mathcal{N}(\mu_i,\sigma_i^2)[\,0,\infty)\)</span>
</li>
<li>a flat prior on the shape of each transition <span class="math inline">\(\operatorname{shape}_{\,i} \sim
\operatorname{Uniform}(a_i, b_i)\)</span>
</li>
<li>it is assumed that the observation process (visit spacing) is fixed,
e.g. every 6 weeks. This means that all transition times are interval
censored.</li>
</ol>
<p>We treat recruitment times as independent of outcome. They can be
modeled separately if required.</p>
<p>We assume that all times are given in months.</p>
<div class="section level2">
<h2 id="specifying-the-model">Specifying the model<a class="anchor" aria-label="anchor" href="#specifying-the-model"></a>
</h2>
<p>The following code defined the prior assumptions for a two-group
trial with a visit-spacing of 1.2 months, i.e., about 6 weeks.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mdl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/srp_model.html">create_srp_model</a></span><span class="op">(</span></span>
<span>  <span class="co"># names of the arms/groups</span></span>
<span>  group_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"intervention"</span><span class="op">)</span>,</span>
<span>  <span class="co"># per-group logodds of response|stable</span></span>
<span>  logodds_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/logodds.html">logodds</a></span><span class="op">(</span><span class="fl">.4</span><span class="op">)</span>, <span class="fu"><a href="../reference/logodds.html">logodds</a></span><span class="op">(</span><span class="fl">.6</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  logodds_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="co"># m[i,j] is the median time to next event for group i and transition j</span></span>
<span>  median_time_to_next_event <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">6</span>,</span>
<span>    <span class="fl">2</span>, <span class="fl">8</span>, <span class="fl">12</span></span>
<span>  <span class="op">)</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  <span class="co"># fixed standard deviation of the prior for all median times</span></span>
<span>  median_time_to_next_event_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>    <span class="fl">1</span>,</span>
<span>    byrow <span class="op">=</span> <span class="cn">TRUE</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="co"># the visit interval</span></span>
<span>  visit_spacing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mdl</span><span class="op">)</span></span>
<span><span class="co">#&gt; srp_model&lt;control,intervention&gt;</span></span></code></pre></div>
<p>The model assumptions can be visualized by sampling from the
prior.</p>
</div>
<div class="section level2">
<h2 id="prior-checks">Prior checks<a class="anchor" aria-label="anchor" href="#prior-checks"></a>
</h2>
<p>First, we plot the cumulative distribution functions (CDF) of the
time-to-next-event over the first 36 (months) and the CDF of the
response probabilities per group. These are based on a sample drawn from
the prior distribution of the model. We can re-use the same parameter
sample for sampling from the prior-predictive distribution by separating
the sampling from the plotting steps.</p>
<p>Often, the rate of progression free survival (PFS) at a particular
time point is of interest. This quantity is a direct function of the
model parameters. Since the simplified model does not distinguish
between progression or death, we denote the combined endpoint as
“progression”. <span class="math display">\[
\begin{align}
\operatorname{PFS}(t) :&amp;= \operatorname{Pr}\big[\,\text{no
progression before } t\,\big] \\
  &amp;= 1 - \operatorname{Pr}\big[\,\text{progression before } t\,] \\
  &amp;= 1 - \operatorname{Pr}\big[\,\text{progression before } t\,|\,
\text{response}\,]\cdot\operatorname{Pr}\big[\,\text{response}\,] \\
  &amp;\qquad- \operatorname{Pr}\big[\,\text{progression before } t\,|\,
\text{no response}\,]\cdot\operatorname{Pr}\big[\,\text{no response}\,]
\\
  &amp;= 1 - p\cdot\int_0^t f_1(u) \cdot F_2(t - u) \operatorname{d}u -
(1 - p)\cdot F_3(t) \ .
\end{align}
\]</span> The integral arises from the need to reflect the uncertainty
over the state change from “stable” to “response” on the way to
“progression”. Any parameter sample thus also induces a sample of the
PFS rate at any given time point and the curve of PFS rate over time
corresponds to the survival function of the “progression or death”
event.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">smpl_prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_prior.html">sample_prior</a></span><span class="op">(</span><span class="va">mdl</span>, seed <span class="op">=</span> <span class="fl">36L</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mdl</span>, dt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">36</span><span class="op">)</span>, sample <span class="op">=</span> <span class="va">smpl_prior</span><span class="op">)</span></span></code></pre></div>
<p><img src="oncomsm_files/figure-html/plotting-the-prior-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="sampling-from-the-prior-predictive-distribution">Sampling from the prior-predictive distribution<a class="anchor" aria-label="anchor" href="#sampling-from-the-prior-predictive-distribution"></a>
</h2>
<p>Next, we draw samples from the prior-predictive distribution of the
model. We sample 100 trials with 30 individuals per arm. Here, we can
re-use the sample prior sample already used for plotting.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl_prior_predictive</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Model.html">sample_predictive</a></span><span class="op">(</span></span>
<span>  <span class="va">mdl</span>,</span>
<span>  sample <span class="op">=</span> <span class="va">smpl_prior</span>,</span>
<span>  n_per_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30L</span>, <span class="fl">30L</span><span class="op">)</span>,</span>
<span>  nsim <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">342</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">tbl_prior_predictive</span>, n <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 67,938 × 5</span></span></span>
<span><span class="co">#&gt;    subject_id group_id         t state     iter</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> ID00010865 intervention  11.2 stable       1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> ID00010865 intervention  12.4 stable       1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> ID00010865 intervention  13.6 stable       1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> ID00010865 intervention  14.8 response     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> ID00010865 intervention  16.0 response     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> ID00010865 intervention  17.2 response     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> ID00010865 intervention  18.4 response     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> ID00010865 intervention  19.6 response     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> ID00010865 intervention  20.8 response     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> ID00010865 intervention  22.0 response     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> ID00010865 intervention  23.2 response     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> ID00010865 intervention  24.4 response     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> ID00010865 intervention  25.6 response     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> ID00010865 intervention  26.8 response     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> ID00010865 intervention  28.0 response     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> ID00010865 intervention  29.2 response     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> ID00010865 intervention  30.4 response     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> ID00010865 intervention  31.6 response     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> ID00010865 intervention  32.8 response     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> ID00010865 intervention  34.0 response     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">21</span> ID00010865 intervention  35.2 response     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">22</span> ID00010865 intervention  36.4 response     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">23</span> ID00010865 intervention  37.6 response     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">24</span> ID00010865 intervention  38.8 response     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">25</span> ID00010865 intervention  40.0 response     1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 67,913 more rows</span></span></span></code></pre></div>
<p>We can then run some quick checks on the sampled data, e.g., the
observed response rates.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl_prior_predictive</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">group_id</span>, <span class="va">iter</span>, <span class="va">subject_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>    responder <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">state</span> <span class="op">==</span> <span class="st">"response"</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">group_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>    p_response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">responder</span><span class="op">)</span>,</span>
<span>    se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">responder</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">#&gt;   group_id     p_response      se</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> control           0.367 0.008<span style="text-decoration: underline;">80</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> intervention      0.559 0.009<span style="text-decoration: underline;">07</span></span></span></code></pre></div>
<p>A crude approximation of the median transition times can be compared
with the prior means.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl_prior_predictive</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">subject_id</span>, <span class="va">iter</span>, <span class="va">state</span>, .keep_all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">iter</span>, <span class="va">group_id</span>, <span class="va">subject_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>    dt <span class="op">=</span> <span class="va">t</span> <span class="op">-</span> <span class="fu">lag</span><span class="op">(</span><span class="va">t</span><span class="op">)</span>,</span>
<span>    from <span class="op">=</span> <span class="fu">lag</span><span class="op">(</span><span class="va">state</span><span class="op">)</span>,</span>
<span>    to <span class="op">=</span> <span class="va">state</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">to</span> <span class="op">!=</span> <span class="st">"stable"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">group_id</span>, <span class="va">from</span>, <span class="va">to</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>    `median transition time` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">dt</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt;   group_id     from     to          `median transition time`</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> control      response progression                     6   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> control      stable   progression                     2.4 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> control      stable   response                        3.60</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> intervention response progression                    12   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> intervention stable   progression                     8.4 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> intervention stable   response                        2.4</span></span></code></pre></div>
<p>By default, the prior predictive distribution is given in terms of
panel visit data. The data can be transformed to interval-censored
multi-state representation, (here only first sampled trial).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl_mstate</span> <span class="op">&lt;-</span> <span class="va">tbl_prior_predictive</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">iter</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/visits_to_mstate.html">visits_to_mstate</a></span><span class="op">(</span><span class="va">mdl</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tbl_mstate</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 92 × 7</span></span></span>
<span><span class="co">#&gt;    subject_id group_id     from     to          t_min t_max t_sot</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> ID00010865 intervention stable   response    13.6  14.8  11.2 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> ID00010865 intervention response progression 55.6  56.8  11.2 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> ID00019694 intervention stable   progression 33.8  35.0  18.2 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> ID00294641 intervention stable   progression 28.6  29.8  23.8 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> ID00559801 intervention stable   response    22.9  24.1  22.9 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> ID00559801 intervention response progression 43.3  44.5  22.9 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> ID00827488 control      stable   progression 13.2  14.4   7.19</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> ID01007254 control      stable   response    24.6  25.8  23.4 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> ID01007254 control      response progression 34.2  35.4  23.4 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> ID01039842 control      stable   response     1.45  2.65  1.45</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 82 more rows</span></span></span></code></pre></div>
<p>The multi-state data can be visualized in swimmer plots.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_mstate.html">plot_mstate</a></span><span class="op">(</span><span class="va">tbl_mstate</span>, <span class="va">mdl</span><span class="op">)</span></span></code></pre></div>
<p><img src="oncomsm_files/figure-html/plot-preior-predictive-1.png" width="672" style="display: block; margin: auto;"></p>
<p>It is also possible to simulate from the prior predictive
distribution while fixing some of the parameter values. Fixing parameter
values can be interpreted as conditioning on some or all of the
parameters. For instance one could set the response probabilities to
fixed values of <span class="math inline">\(0.1\)</span> and <span class="math inline">\(0.9\)</span>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Model.html">sample_predictive</a></span><span class="op">(</span></span>
<span>    <span class="va">mdl</span>,</span>
<span>    sample <span class="op">=</span> <span class="va">smpl_prior</span>,</span>
<span>    p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>    n_per_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30L</span>, <span class="fl">30L</span><span class="op">)</span>,</span>
<span>    nsim <span class="op">=</span> <span class="fl">100</span>,</span>
<span>    seed <span class="op">=</span> <span class="fl">3423423</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">group_id</span>, <span class="va">iter</span>, <span class="va">subject_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>    responder <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">state</span> <span class="op">==</span> <span class="st">"response"</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">group_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>    p_response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">responder</span><span class="op">)</span>,</span>
<span>    se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">responder</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">#&gt;   group_id     p_response      se</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> control           0.093 0.005<span style="text-decoration: underline;">30</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> intervention      0.863 0.006<span style="text-decoration: underline;">28</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="a-hypothetical-interim-analysis">A hypothetical interim analysis<a class="anchor" aria-label="anchor" href="#a-hypothetical-interim-analysis"></a>
</h2>
<p>First, we sample a single data set under extreme response
probabilities that deviate from the chosen prior. The data can then be
curtailed to a hypothetical interim time-point simply by filtering the
visit time-points.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl_data_interim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Model.html">sample_predictive</a></span><span class="op">(</span></span>
<span>    <span class="va">mdl</span>,</span>
<span>    sample <span class="op">=</span> <span class="va">smpl_prior</span>,</span>
<span>    p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.8</span><span class="op">)</span>,</span>
<span>    n_per_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30L</span>, <span class="fl">30L</span><span class="op">)</span>,</span>
<span>    nsim <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    seed <span class="op">=</span> <span class="fl">42L</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">t</span> <span class="op">&lt;=</span> <span class="fl">15</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>The censoring in the interim data can be visualized in a swimmer plot
again.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl_data_interim</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/visits_to_mstate.html">visits_to_mstate</a></span><span class="op">(</span><span class="va">mdl</span>, now <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/plot_mstate.html">plot_mstate</a></span><span class="op">(</span><span class="va">mdl</span>, relative_to_sot <span class="op">=</span> <span class="cn">FALSE</span>, now <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<p><img src="oncomsm_files/figure-html/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;"></p>
<p>We can check the observed response rates again. Due to censoring at
the interim time point, the response rate estimate is biased.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tbl_data_interim</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">group_id</span>, <span class="va">iter</span>, <span class="va">subject_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>    responder <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">state</span> <span class="op">==</span> <span class="st">"response"</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">group_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>    p_response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">responder</span><span class="op">)</span>,</span>
<span>    se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">responder</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">#&gt;   group_id     p_response    se</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> control           0.143 0.143</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> intervention      0.7   0.153</span></span></code></pre></div>
<p>Instead, one can now do inference by drawing sample from the
posterior distribution this will account for censoring. Since the data
conflicts with the prior, the posterior mass will move in the direction
of the observed response rates.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">smpl_posterior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_posterior.html">sample_posterior</a></span><span class="op">(</span><span class="va">mdl</span>, <span class="va">tbl_data_interim</span>, seed <span class="op">=</span> <span class="fl">43L</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mdl</span>, dt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">36</span><span class="op">)</span>, sample <span class="op">=</span> <span class="va">smpl_posterior</span><span class="op">)</span></span></code></pre></div>
<p><img src="oncomsm_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># calculate posterior quantiles of response probability</span></span>
<span><span class="va">smpl_posterior</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/parameter_sample_to_tibble.html">parameter_sample_to_tibble</a></span><span class="op">(</span><span class="va">mdl</span>, <span class="va">.</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">parameter</span> <span class="op">==</span> <span class="st">"p"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">group_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>    p_posterior_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>,</span>
<span>    q25 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">value</span>, probs <span class="op">=</span> <span class="fl">.25</span><span class="op">)</span>,</span>
<span>    q75 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">value</span>, probs <span class="op">=</span> <span class="fl">.75</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 4</span></span></span>
<span><span class="co">#&gt;   group_id     p_posterior_mean   q25   q75</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> control                 0.287 0.203 0.395</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> intervention            0.838 0.763 0.894</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.2.2 (2022-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.1 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3</span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] ggplot2_3.4.0      dplyr_1.0.10       oncomsm_0.1.1.9000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] Rcpp_1.0.9           tidyr_1.2.1          prettyunits_1.1.1   </span></span>
<span><span class="co">#&gt;  [4] ps_1.7.2             visNetwork_2.1.2     rprojroot_2.0.3     </span></span>
<span><span class="co">#&gt;  [7] digest_0.6.30        utf8_1.2.2           R6_2.5.1            </span></span>
<span><span class="co">#&gt; [10] backports_1.4.1      stats4_4.2.2         evaluate_0.18       </span></span>
<span><span class="co">#&gt; [13] highr_0.9            pillar_1.8.1         rlang_1.0.6         </span></span>
<span><span class="co">#&gt; [16] callr_3.7.3          jquerylib_0.1.4      checkmate_2.1.0     </span></span>
<span><span class="co">#&gt; [19] rmarkdown_2.18       DiagrammeR_1.0.9     pkgdown_2.0.6       </span></span>
<span><span class="co">#&gt; [22] labeling_0.4.2       textshaping_0.3.6    desc_1.4.2          </span></span>
<span><span class="co">#&gt; [25] stringr_1.4.1        htmlwidgets_1.5.4    loo_2.5.1           </span></span>
<span><span class="co">#&gt; [28] munsell_0.5.0        compiler_4.2.2       xfun_0.35           </span></span>
<span><span class="co">#&gt; [31] rstan_2.21.7         pkgconfig_2.0.3      systemfonts_1.0.4   </span></span>
<span><span class="co">#&gt; [34] pkgbuild_1.3.1       htmltools_0.5.3      tidyselect_1.2.0    </span></span>
<span><span class="co">#&gt; [37] tibble_3.1.8         gridExtra_2.3        codetools_0.2-18    </span></span>
<span><span class="co">#&gt; [40] matrixStats_0.63.0   fansi_1.0.3          crayon_1.5.2        </span></span>
<span><span class="co">#&gt; [43] withr_2.5.0          grid_4.2.2           jsonlite_1.8.3      </span></span>
<span><span class="co">#&gt; [46] gtable_0.3.1         lifecycle_1.0.3      magrittr_2.0.3      </span></span>
<span><span class="co">#&gt; [49] StanHeaders_2.21.0-7 scales_1.2.1         RcppParallel_5.1.5  </span></span>
<span><span class="co">#&gt; [52] cli_3.4.1            stringi_1.7.8        cachem_1.0.6        </span></span>
<span><span class="co">#&gt; [55] farver_2.1.1         fs_1.5.2             bslib_0.4.1         </span></span>
<span><span class="co">#&gt; [58] ellipsis_0.3.2       ragg_1.2.4           generics_0.1.3      </span></span>
<span><span class="co">#&gt; [61] vctrs_0.5.1          RColorBrewer_1.1-3   tools_4.2.2         </span></span>
<span><span class="co">#&gt; [64] glue_1.6.2           purrr_0.3.5          processx_3.8.0      </span></span>
<span><span class="co">#&gt; [67] parallel_4.2.2       fastmap_1.1.0        yaml_2.3.6          </span></span>
<span><span class="co">#&gt; [70] inline_0.3.19        colorspace_2.0-3     memoise_2.0.1       </span></span>
<span><span class="co">#&gt; [73] knitr_1.41           patchwork_1.1.2      sass_0.4.4</span></span></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-aubel_bayesian_2021" class="csl-entry">
Aubel, Paul, Marine Antigny, Ronan Fougeray, Frédéric Dubois, and Gaëlle
Saint‐Hilary. 2021. <span>“A Bayesian Approach for Event Predictions in
Clinical Trials with Time‐to‐event Outcomes.”</span> <em>Statistics in
Medicine</em> 40 (28): 6344–59. <a href="https://doi.org/10.1002/sim.9186" class="external-link">https://doi.org/10.1002/sim.9186</a>.
</div>
<div id="ref-beyer_multistate_2020" class="csl-entry">
Beyer, Ulrich, David Dejardin, Matthias Meller, Kaspar Rufibach, and
Hans Ulrich Burger. 2020. <span>“A Multistate Model for Early
Decision-Making in Oncology.”</span> <em>Biometrical Journal</em> 62
(3): 550–67. <a href="https://doi.org/10.1002/bimj.201800250" class="external-link">https://doi.org/10.1002/bimj.201800250</a>.
</div>
<div id="ref-jackson_flexible_2022" class="csl-entry">
Jackson, Christopher. 2022. <span>“Flexible Parametric Multi-State
Modelling with Flexsurv.”</span> <a href="https://cran.r-project.org/web/packages/flexsurv/" class="external-link">https://cran.r-project.org/web/packages/flexsurv/</a>.
</div>
<div id="ref-jackson_comparison_2022" class="csl-entry">
Jackson, Christopher, Brian Tom, Peter Kirwan, Sema Mandal, Shaun R
Seaman, Kevin Kunzmann, Anne Presanis, and Daniela De Angelis. 2022.
<span>“A Comparison of Two Frameworks for Multi-State Modelling, Applied
to Outcomes After Hospital Admissions with
<span>COVID</span>-19.”</span> <em>Statistical Methods in Medical
Research</em>, July, 09622802221106720. <a href="https://doi.org/10.1177/09622802221106720" class="external-link">https://doi.org/10.1177/09622802221106720</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Kevin Kunzmann, Boehringer Ingelheim Ltd..</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
